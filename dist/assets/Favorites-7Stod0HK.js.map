{"version":3,"file":"Favorites-7Stod0HK.js","sources":["../../src/assets/images/img_not_favorites.jpeg","../../src/components/NoFavoritePsychologists/NoFavoritePsychologists.jsx","../../src/pages/favorites/Favorites.jsx"],"sourcesContent":["export default \"__VITE_ASSET__DHeB0E9O__\"","import css from './style.module.css';\nimport noFavoritesImage from '../../assets/images/img_not_favorites.jpeg';\n\nconst NoFavoritePsychologists = () => {\n  const handleRedirect = () => {\n    window.location.href = '/psychologists';\n  };\n\n  return (\n    <div className={css.no_favorites_page}>\n      <img src={noFavoritesImage} alt=\"No favorites\" className={css.no_favorites_image} />\n      <p className={css.no_favorites_text}>\n        It looks like you haven`t added any psychologists to your favorites yet.\n      </p>\n      <button className={css.no_favorites_button} onClick={handleRedirect}>\n        Find Psychologists\n      </button>\n    </div>\n  );\n};\n\nexport default NoFavoritePsychologists;\n","import css from './style.module.css';\nimport { useEffect, useState } from 'react';\nimport { ref, onValue } from 'firebase/database';\nimport NoFavoritePsychologists from '../../components/NoFavoritePsychologists/NoFavoritePsychologists';\nimport PsychologistCard from '../../components/PsychologistsCard/PsychologistsCard';\nimport SortFilter from '../../components/SortFilter/SortFilter';\nimport {\n  selectFavoritePsychologists,\n  selectFilter,\n  selectSortType,\n  selectFilteredAndSortedFavorites,\n} from '../../redux/psychologitsts/psychologistsSelector';\nimport {\n  setFavoriteIds,\n  setFilter,\n  setSortType,\n} from '../../redux/psychologitsts/psychologistsSlice';\nimport { useDispatch, useSelector } from 'react-redux';\nimport {\n  fetchUserFavorites,\n  addFavoritesPsychologists,\n  removeFavoritePsychologist,\n} from '../../redux/psychologitsts/psychologistsOperation';\nimport { getAuth } from 'firebase/auth';\nimport { db } from '../../firebaseConfig';\n\nconst Favorites = ({ userId }) => {\n  const dispatch = useDispatch();\n  const filteredAndSortedFavorites = useSelector(selectFilteredAndSortedFavorites);\n\n  const sortType = useSelector(selectSortType);\n  const filter = useSelector(selectFilter);\n  const [isAuth, setIsAuth] = useState(false);\n\n  useEffect(() => {\n    const auth = getAuth();\n    setIsAuth(!!auth.currentUser);\n\n    if (userId) {\n      dispatch(fetchUserFavorites(userId));\n    }\n  }, [dispatch, userId]);\n\n  useEffect(() => {\n    const auth = getAuth();\n    const user = auth.currentUser;\n\n    if (user) {\n      const favoriteRef = ref(db, `users/${user.uid}/favorites`);\n      const unsubscribe = onValue(favoriteRef, snapshot => {\n        const favoritesData = snapshot.val();\n        const favoritesIds = favoritesData ? Object.keys(favoritesData) : [];\n        dispatch(setFavoriteIds(favoritesIds));\n      });\n\n      return () => unsubscribe();\n    } else {\n      const storedFavorites = JSON.parse(localStorage.getItem('favorites')) || [];\n      dispatch(setFavoriteIds(storedFavorites));\n    }\n  }, [dispatch, isAuth]);\n\n  const handleSortChange = e => {\n    dispatch(setSortType(e.target.value));\n  };\n\n  const handleFilterChange = e => {\n    dispatch(setFilter(e.target.value));\n  };\n\n  const handleFavoriteToggle = psychologistId => {\n    if (!isAuth) {\n      alert('This feature is available only for authorized users.');\n      return;\n    }\n\n    const isFavorite = filteredAndSortedFavorites.some(\n      psychologist => psychologist.id === psychologistId\n    );\n\n    if (isFavorite) {\n      dispatch(removeFavoritePsychologist({ userId, psychologistId }));\n    } else {\n      dispatch(addFavoritesPsychologists({ userId, psychologistId }));\n    }\n  };\n\n  return (\n    <>\n      <div className={css.favorites_page}>\n        {filteredAndSortedFavorites.length > 0 ? (\n          <>\n            <SortFilter\n              sortType={sortType}\n              filter={filter}\n              onSortChange={handleSortChange}\n              onFilterChange={handleFilterChange}\n            />\n            <div className={css.psychologists_list}>\n              {filteredAndSortedFavorites.map(psychologist => (\n                <PsychologistCard\n                  key={psychologist.id}\n                  psychologist={psychologist}\n                  isFavorite={true} // All displayed psychologists are favorites\n                  onFavoriteToggle={() => handleFavoriteToggle(psychologist.id)}\n                />\n              ))}\n            </div>\n          </>\n        ) : (\n          <NoFavoritePsychologists />\n        )}\n      </div>\n    </>\n  );\n};\n\nexport default Favorites;\n"],"names":["noFavoritesImage","NoFavoritePsychologists","handleRedirect","jsxs","css","jsx","Favorites","userId","dispatch","useDispatch","filteredAndSortedFavorites","useSelector","selectFilteredAndSortedFavorites","sortType","selectSortType","filter","selectFilter","isAuth","setIsAuth","useState","useEffect","auth","getAuth","fetchUserFavorites","user","favoriteRef","ref","db","unsubscribe","onValue","snapshot","favoritesData","favoritesIds","setFavoriteIds","storedFavorites","handleSortChange","setSortType","handleFilterChange","setFilter","handleFavoriteToggle","psychologistId","isFavorite","psychologist","removeFavoritePsychologist","addFavoritesPsychologists","Fragment","SortFilter","PsychologistCard"],"mappings":"0fAAeA,EAAA,0CCGTC,EAA0B,IAAM,CACpC,MAAMC,EAAiB,IAAM,CAC3B,OAAO,SAAS,KAAO,gBAAA,EAGzB,OACGC,EAAAA,KAAA,MAAA,CAAI,UAAWC,EAAI,kBAClB,SAAA,CAAAC,MAAC,OAAI,IAAKL,EAAkB,IAAI,eAAe,UAAWI,EAAI,mBAAoB,EACjFC,EAAA,IAAA,IAAA,CAAE,UAAWD,EAAI,kBAAmB,SAErC,2EAAA,QACC,SAAO,CAAA,UAAWA,EAAI,oBAAqB,QAASF,EAAgB,SAErE,qBAAA,CACF,CAAA,CAAA,CAEJ,ECOMI,EAAY,CAAC,CAAE,OAAAC,KAAa,CAChC,MAAMC,EAAWC,IACXC,EAA6BC,EAAYC,CAAgC,EAEzEC,EAAWF,EAAYG,CAAc,EACrCC,EAASJ,EAAYK,CAAY,EACjC,CAACC,EAAQC,CAAS,EAAIC,WAAS,EAAK,EAE1CC,EAAAA,UAAU,IAAM,CACd,MAAMC,EAAOC,IACHJ,EAAA,CAAC,CAACG,EAAK,WAAW,EAExBd,GACOC,EAAAe,EAAmBhB,CAAM,CAAC,CACrC,EACC,CAACC,EAAUD,CAAM,CAAC,EAErBa,EAAAA,UAAU,IAAM,CAEd,MAAMI,EADOF,IACK,YAElB,GAAIE,EAAM,CACR,MAAMC,EAAcC,EAAIC,EAAI,SAASH,EAAK,GAAG,YAAY,EACnDI,EAAcC,EAAQJ,EAAyBK,GAAA,CAC7C,MAAAC,EAAgBD,EAAS,MACzBE,EAAeD,EAAgB,OAAO,KAAKA,CAAa,EAAI,GACzDvB,EAAAyB,EAAeD,CAAY,CAAC,CAAA,CACtC,EAED,MAAO,IAAMJ,EAAY,CAAA,KACpB,CACC,MAAAM,EAAkB,KAAK,MAAM,aAAa,QAAQ,WAAW,CAAC,GAAK,GAChE1B,EAAAyB,EAAeC,CAAe,CAAC,CAC1C,CAAA,EACC,CAAC1B,EAAUS,CAAM,CAAC,EAErB,MAAMkB,EAAwB,GAAA,CAC5B3B,EAAS4B,EAAY,EAAE,OAAO,KAAK,CAAC,CAAA,EAGhCC,EAA0B,GAAA,CAC9B7B,EAAS8B,EAAU,EAAE,OAAO,KAAK,CAAC,CAAA,EAG9BC,EAAyCC,GAAA,CAC7C,GAAI,CAACvB,EAAQ,CACX,MAAM,sDAAsD,EAC5D,MACF,CAEA,MAAMwB,EAAa/B,EAA2B,KAC5CgC,GAAgBA,EAAa,KAAOF,CAAA,EAIpChC,EADEiC,EACOE,EAA2B,CAAE,OAAApC,EAAQ,eAAAiC,CAAA,CAAgB,EAErDI,EAA0B,CAAE,OAAArC,EAAQ,eAAAiC,CAAA,CAAgB,CAFE,CAGjE,EAIA,OAAAnC,EAAAA,IAAAwC,EAAAA,SAAA,CACE,eAAC,MAAI,CAAA,UAAWzC,EAAI,eACjB,SAAAM,EAA2B,OAAS,EAEjCP,OAAA0C,EAAAA,SAAA,CAAA,SAAA,CAAAxC,EAAA,IAACyC,EAAA,CACC,SAAAjC,EACA,OAAAE,EACA,aAAcoB,EACd,eAAgBE,CAAA,CAClB,QACC,MAAI,CAAA,UAAWjC,EAAI,mBACjB,SAAAM,EAA2B,IAC1BgC,GAAArC,EAAA,IAAC0C,EAAA,CAEC,aAAAL,EACA,WAAY,GACZ,iBAAkB,IAAMH,EAAqBG,EAAa,EAAE,CAAA,EAHvDA,EAAa,EAKrB,CAAA,EACH,CAAA,CACF,CAAA,EAEArC,EAAAA,IAACJ,EAAwB,CAAA,CAAA,CAAA,CAE7B,CACF,CAAA,CAEJ"}